version: '2022-10-03'
kind: Endpoint
metadata:
    name: banking_data_api
config:
    endpoints:
        - baseurl:
            kind: baseurl
            url: https://management.azure.com/{scope}/{other}
            params:
                - scope:
                    name: scope_param
                - other:
                    name: other
        - reservationlist:
            kind: relativeurl
            base: baseurl
            relative: /providers/Microsoft.Capicity/reservation
            params:
                - reservationOrderId:
                    param: reservationOrderId
        - scope:
            kind: relativeurl
            base: baseurl
            relative: /scope/

    params:
        reservationOrderId:
            name: reservationOrderId
            type: String
            resolver: DBReservationLoader
        scope_param:
            name: scope_param
            type: String
            resolver:
                name: EndpointScopeResolver
                table: 3 # TODO: Implement
                col: xxx # TODO: Implement
            descr: Scope used in retrieval of something
        other:
            name: other
            type: String
            resolver: DBOtherResolver
    resolvers:
        EndpointScopeResolver:
            kind: EndpointResolver
            endpoint: scope
            authentication:
                method: NameAndKey
        DBReservationLoader:
            kind: DatabaseResolver
            connectionstring: "Some string that should be put into a secret"
            authentication: 
                method: NameAndKey
            table:
                name: Configuration
                col: ['Id']
        DBOtherResolver:
            kind: DatabaseResolver
            connectionstring: "something"
            authentication:
                method: NameAndKey
            table:
                name: OtherTable
                col: ['name'] 

    


    